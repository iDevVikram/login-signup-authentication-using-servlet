package com.cetpa;
import javax.servlet.*;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.*;
import java.io.*;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

@WebServlet("/authenticateuser")
public class LoginServlet extends HttpServlet 
{
	public void service(HttpServletRequest request ,HttpServletResponse response)throws ServletException,IOException
	{
		String email=request.getParameter("loginEmail");
		String password=request.getParameter("loginPassword");
		PrintWriter pw= response.getWriter();
	    pw.println("<html>");
		pw.println("<body>");
		try {
			Class.forName("com.mysql.cj.jdbc.Driver");
			Connection cn=DriverManager.getConnection("jdbc:mysql://localhost/servlet10","root","A2019cse@6991");
		    PreparedStatement ps = cn.prepareStatement("select * from userinfo where email=?");
		    ps.setString(1, email);
		    ResultSet rst=ps.executeQuery();
		    
		    if(rst.next()) {
		    	
		    }
		    else {
		    	RequestDispatcher dp= request.getRequestDispatcher("Index.html");
				dp.include(request,response);
				
				pw.println("<h1 style='color:red'>You have entered wrong id and password </h1>");
				
		    }
		}
		catch(Exception ex){
			
		}
		pw.println("</body>");
		pw.println("</html>");
	}
}
